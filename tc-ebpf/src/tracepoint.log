vboxuser@ubuntu-1:~/nixos-tc-aya-test$ sudo ./target/release/tc-aya  --file "file.txt" --log true
[2024-06-29T19:59:03Z INFO  tc_aya] Waiting for Ctrl-C...
[2024-06-29T19:59:05Z INFO  tc] TCP,SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.6 :58585 -> 192.168.1.11:49000
[2024-06-29T19:59:05Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.6 :58585 -> 192.168.1.11:49000
[2024-06-29T19:59:05Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate SYN_RECV, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T19:59:05Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate ESTABLISHED, oldstate SYN_RECV, 192.168.1.11:49000 -> 192.168.1.6:58585
[2024-06-29T19:59:10Z INFO  tc] TCP,SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.5 :45592 -> 192.168.1.11:49000
[2024-06-29T19:59:10Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :45592 -> 192.168.1.11:49000
[2024-06-29T19:59:10Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate SYN_RECV, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T19:59:10Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate ESTABLISHED, oldstate SYN_RECV, 192.168.1.11:49000 -> 192.168.1.5:45592
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate FIN_WAIT1, oldstate ESTABLISHED, 192.168.1.11:49000 -> 192.168.1.6:58585
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate FIN_WAIT1, oldstate ESTABLISHED, 192.168.1.11:49000 -> 192.168.1.5:45592
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e5274a400,protocol:6 newstate CLOSE, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate FIN_WAIT1, oldstate FIN_WAIT1, 192.168.1.11:49000 -> 192.168.1.6:58585
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate FIN_WAIT1, oldstate FIN_WAIT1, 192.168.1.11:49000 -> 192.168.1.5:45592
[2024-06-29T19:59:31Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :45592 -> 192.168.1.11:49000
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate FIN_WAIT2, oldstate FIN_WAIT1, 192.168.1.11:49000 -> 192.168.1.5:45592
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate CLOSE, oldstate FIN_WAIT2, 192.168.1.11:49000 -> 192.168.1.5:45592
[2024-06-29T19:59:31Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.6 :58585 -> 192.168.1.11:49000
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate FIN_WAIT2, oldstate FIN_WAIT1, 192.168.1.11:49000 -> 192.168.1.6:58585
[2024-06-29T19:59:31Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate CLOSE, oldstate FIN_WAIT2, 192.168.1.11:49000 -> 192.168.1.6:58585
[2024-06-29T19:59:31Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=1,FIN=0 192.168.1.6 :58585 -> 192.168.1.11:49000
^C[2024-06-29T19:59:38Z INFO  tc_aya] Exiting...












[2024-06-29T20:19:43Z WARN  tc] skaddr: 0xffff932e49308000,protocol:6 newstate LISTEN, oldstate CLOSE, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T20:19:50Z INFO  tc] TCP,SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.5 :47662 -> 192.168.1.11:49000
[2024-06-29T20:19:50Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :47662 -> 192.168.1.11:49000
[2024-06-29T20:19:50Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate SYN_RECV, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T20:19:50Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate ESTABLISHED, oldstate SYN_RECV, 192.168.1.11:49000 -> 192.168.1.5:47662
[2024-06-29T20:19:51Z INFO  tc] TCP,SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.6 :58643 -> 192.168.1.11:49000
[2024-06-29T20:19:51Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.6 :58643 -> 192.168.1.11:49000
[2024-06-29T20:19:51Z WARN  tc] skaddr: 0xffff932e5274a400,protocol:6 newstate SYN_RECV, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T20:19:51Z WARN  tc] skaddr: 0xffff932e5274a400,protocol:6 newstate ESTABLISHED, oldstate SYN_RECV, 192.168.1.11:49000 -> 192.168.1.6:58643
[2024-06-29T20:19:54Z INFO  tc] TCP,SYN=0,ACK=1,PSH=1,RST=0,FIN=0 192.168.1.5 :47662 -> 192.168.1.11:49000
[2024-06-29T20:19:56Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=1 192.168.1.5 :47662 -> 192.168.1.11:49000
[2024-06-29T20:19:56Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate CLOSE_WAIT, oldstate ESTABLISHED, 192.168.1.11:49000 -> 192.168.1.5:47662
[2024-06-29T20:19:56Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate LAST_ACK, oldstate CLOSE_WAIT, 192.168.1.11:49000 -> 192.168.1.5:47662
[2024-06-29T20:19:56Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :47662 -> 192.168.1.11:49000
[2024-06-29T20:19:56Z WARN  tc] skaddr: 0xffff932e5274f500,protocol:6 newstate CLOSE, oldstate LAST_ACK, 192.168.1.11:49000 -> 192.168.1.5:47662






vboxuser@ubuntu-1:~/nixos-tc-aya-test$ sudo ./target/release/tc-aya  --file "file.txt" --log true
[2024-06-29T20:21:29Z INFO  tc_aya] Waiting for Ctrl-C...
[2024-06-29T20:21:33Z WARN  tc] skaddr: 0xffff932e5274a400,protocol:6 newstate LISTEN, oldstate CLOSE, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T20:21:39Z INFO  tc] TCP,SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.5 :60214 -> 192.168.1.11:49000
[2024-06-29T20:21:39Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :60214 -> 192.168.1.11:49000
[2024-06-29T20:21:39Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate SYN_RECV, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T20:21:39Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate ESTABLISHED, oldstate SYN_RECV, 192.168.1.11:49000 -> 192.168.1.5:60214
[2024-06-29T20:21:41Z INFO  tc] TCP,SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.6 :58647 -> 192.168.1.11:49000
[2024-06-29T20:21:41Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.6 :58647 -> 192.168.1.11:49000
[2024-06-29T20:21:41Z WARN  tc] skaddr: 0xffff932e5274da00,protocol:6 newstate SYN_RECV, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-06-29T20:21:41Z WARN  tc] skaddr: 0xffff932e5274da00,protocol:6 newstate ESTABLISHED, oldstate SYN_RECV, 192.168.1.11:49000 -> 192.168.1.6:58647
[2024-06-29T20:21:43Z INFO  tc] TCP,SYN=0,ACK=1,PSH=1,RST=0,FIN=0 192.168.1.5 :60214 -> 192.168.1.11:49000
[2024-06-29T20:21:44Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=1 192.168.1.5 :60214 -> 192.168.1.11:49000
[2024-06-29T20:21:44Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate CLOSE_WAIT, oldstate ESTABLISHED, 192.168.1.11:49000 -> 192.168.1.5:60214
[2024-06-29T20:21:44Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate LAST_ACK, oldstate CLOSE_WAIT, 192.168.1.11:49000 -> 192.168.1.5:60214
[2024-06-29T20:21:44Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :60214 -> 192.168.1.11:49000
[2024-06-29T20:21:44Z WARN  tc] skaddr: 0xffff932e52749b00,protocol:6 newstate CLOSE, oldstate LAST_ACK, 192.168.1.11:49000 -> 192.168.1.5:60214
[2024-06-29T20:21:46Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=1,FIN=0 192.168.1.6 :58647 -> 192.168.1.11:49000
[2024-06-29T20:21:46Z WARN  tc] skaddr: 0xffff932e5274da00,protocol:6 newstate CLOSE, oldstate ESTABLISHED, 192.168.1.11:49000 -> 192.168.1.6:58647
[2024-06-29T20:21:47Z WARN  tc] skaddr: 0xffff932edddc1200,protocol:6 newstate SYN_SENT, oldstate CLOSE, 192.168.1.11:0 -> 185.125.190.98:80
[2024-06-29T20:21:47Z INFO  tc] TCP,SYN=1,ACK=1,PSH=0,RST=0,FIN=0 185.125.190.98 :80 -> 192.168.1.11:52356
[2024-06-29T20:21:47Z WARN  tc] skaddr: 0xffff932edddc1200,protocol:6 newstate ESTABLISHED, oldstate SYN_SENT, 192.168.1.11:52356 -> 185.125.190.98:80
[2024-06-29T20:21:47Z INFO  tc] TCP,SYN=0,ACK=1,PSH=1,RST=0,FIN=0 185.125.190.98 :80 -> 192.168.1.11:52356
[2024-06-29T20:21:47Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=1 185.125.190.98 :80 -> 192.168.1.11:52356
[2024-06-29T20:21:47Z WARN  tc] skaddr: 0xffff932edddc1200,protocol:6 newstate CLOSE_WAIT, oldstate ESTABLISHED, 192.168.1.11:52356 -> 185.125.190.98:80
[2024-06-29T20:21:47Z WARN  tc] skaddr: 0xffff932edddc1200,protocol:6 newstate LAST_ACK, oldstate CLOSE_WAIT, 192.168.1.11:52356 -> 185.125.190.98:80
[2024-06-29T20:21:47Z INFO  tc] TCP,SYN=0,ACK=1,PSH=0,RST=0,FIN=0 185.125.190.98 :80 -> 192.168.1.11:52356
[2024-06-29T20:21:47Z WARN  tc] skaddr: 0xffff932edddc1200,protocol:6 newstate CLOSE, oldstate LAST_ACK, 192.168.1.11:52356 -> 185.125.190.98:80







Server -ingress/egress

[2024-07-01T09:14:02Z WARN  tc] skaddr: 0xffff936143148900,protocol:6 newstate LISTEN, oldstate CLOSE, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-07-01T09:14:12Z INFO  tc] TCP[IN],SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.5 :34538 -> 192.168.1.11:49000
[2024-07-01T09:14:12Z INFO  tc] TCP[OUT],SYN=1,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.11 :49000 -> 192.168.1.5:34538
[2024-07-01T09:14:12Z INFO  tc] TCP[IN],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :34538 -> 192.168.1.11:49000
[2024-07-01T09:14:12Z WARN  tc] skaddr: 0xffff9361431f3f00,protocol:6 newstate SYN_RECV, oldstate LISTEN, 0.0.0.0:49000 -> 0.0.0.0:0
[2024-07-01T09:14:12Z WARN  tc] skaddr: 0xffff9361431f3f00,protocol:6 newstate ESTABLISHED, oldstate SYN_RECV, 192.168.1.11:49000 -> 192.168.1.5:34538
[2024-07-01T09:14:17Z INFO  tc] TCP[IN],SYN=0,ACK=1,PSH=1,RST=0,FIN=0 192.168.1.5 :34538 -> 192.168.1.11:49000
[2024-07-01T09:14:17Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.11 :49000 -> 192.168.1.5:34538


Client -ingress/egress
[2024-07-01T09:16:20Z WARN  tc] skaddr: 0xffff9361431f3f00,protocol:6 newstate SYN_SENT, oldstate CLOSE, 192.168.1.11:0 -> 192.168.1.5:49000
[2024-07-01T09:16:20Z INFO  tc] TCP[OUT],SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.11 :33570 -> 192.168.1.5:49000
[2024-07-01T09:16:20Z INFO  tc] TCP[IN],SYN=1,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :49000 -> 192.168.1.11:33570
[2024-07-01T09:16:20Z WARN  tc] skaddr: 0xffff9361431f3f00,protocol:6 newstate ESTABLISHED, oldstate SYN_SENT, 192.168.1.11:33570 -> 192.168.1.5:49000
[2024-07-01T09:16:20Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.11 :33570 -> 192.168.1.5:49000
[2024-07-01T09:16:21Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=1,RST=0,FIN=0 192.168.1.11 :33570 -> 192.168.1.5:49000
[2024-07-01T09:16:21Z INFO  tc] TCP[IN],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :49000 -> 192.168.1.11:33570



client connection u kapattı
[2024-07-01T10:25:11Z WARN  tc] skaddr: 0xffff9361cc145100,protocol:6 newstate SYN_SENT, oldstate CLOSE, 192.168.1.11:0 -> 192.168.1.5:49000
[2024-07-01T10:25:11Z INFO  tc] TCP[OUT],SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.11 :38884 -> 192.168.1.5:49000
[2024-07-01T10:25:11Z INFO  tc] TCP[IN],SYN=1,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :49000 -> 192.168.1.11:38884
[2024-07-01T10:25:11Z WARN  tc] skaddr: 0xffff9361cc145100,protocol:6 newstate ESTABLISHED, oldstate SYN_SENT, 192.168.1.11:38884 -> 192.168.1.5:49000
[2024-07-01T10:25:11Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.11 :38884 -> 192.168.1.5:49000
[2024-07-01T10:25:13Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=1,RST=0,FIN=0 192.168.1.11 :38884 -> 192.168.1.5:49000
[2024-07-01T10:25:13Z INFO  tc] TCP[IN],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :49000 -> 192.168.1.11:38884
[2024-07-01T10:25:15Z WARN  tc] skaddr: 0xffff9361cc145100,protocol:6 newstate FIN_WAIT1, oldstate ESTABLISHED, 192.168.1.11:38884 -> 192.168.1.5:49000
[2024-07-01T10:25:15Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=0,RST=0,FIN=1 192.168.1.11 :38884 -> 192.168.1.5:49000
[2024-07-01T10:25:15Z INFO  tc] TCP[IN],SYN=0,ACK=1,PSH=0,RST=0,FIN=1 192.168.1.5 :49000 -> 192.168.1.11:38884
[2024-07-01T10:25:15Z WARN  tc] skaddr: 0xffff9361cc145100,protocol:6 newstate FIN_WAIT2, oldstate FIN_WAIT1, 192.168.1.11:38884 -> 192.168.1.5:49000
[2024-07-01T10:25:15Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.11 :38884 -> 192.168.1.5:49000
[2024-07-01T10:25:15Z WARN  tc] skaddr: 0xffff9361cc145100,protocol:6 newstate CLOSE, oldstate FIN_WAIT2, 192.168.1.11:38884 -> 192.168.1.5:49000


server kapattı
[2024-07-01T10:31:05Z INFO  tc_aya] Waiting for Ctrl-C...
[2024-07-01T10:31:12Z WARN  tc] skaddr: 0xffff9361431f3f00,protocol:6 newstate SYN_SENT, oldstate CLOSE, 192.168.1.11:0 -> 192.168.1.5:49000
[2024-07-01T10:31:12Z INFO  tc] TCP[OUT],SYN=1,ACK=0,PSH=0,RST=0,FIN=0 192.168.1.11 :36346 -> 192.168.1.5:49000
[2024-07-01T10:31:12Z INFO  tc] TCP[IN],SYN=1,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :49000 -> 192.168.1.11:36346
[2024-07-01T10:31:12Z WARN  tc] skaddr: 0xffff9361431f3f00,protocol:6 newstate ESTABLISHED, oldstate SYN_SENT, 192.168.1.11:36346 -> 192.168.1.5:49000
[2024-07-01T10:31:12Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.11 :36346 -> 192.168.1.5:49000
[2024-07-01T10:31:13Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=1,RST=0,FIN=0 192.168.1.11 :36346 -> 192.168.1.5:49000
[2024-07-01T10:31:13Z INFO  tc] TCP[IN],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.5 :49000 -> 192.168.1.11:36346
[2024-07-01T10:31:18Z INFO  tc] TCP[IN],SYN=0,ACK=1,PSH=0,RST=0,FIN=1 192.168.1.5 :49000 -> 192.168.1.11:36346
[2024-07-01T10:31:18Z WARN  tc] skaddr: 0xffff9361431f3f00,protocol:6 newstate CLOSE_WAIT, oldstate ESTABLISHED, 192.168.1.11:36346 -> 192.168.1.5:49000
[2024-07-01T10:31:18Z INFO  tc] TCP[OUT],SYN=0,ACK=1,PSH=0,RST=0,FIN=0 192.168.1.11 :36346 -> 192.168.1.5:49000







[2024-07-06T06:13:22Z INFO  tc] [Sock_enter]pid: 204831285361227,family:2,type:2,proto:17
[2024-07-06T06:13:22Z INFO  tc] [Sock_exit]pid: 204831285361227,ret_val:3 
[2024-07-06T06:13:22Z INFO  tc] [Sock_bind]pid: 204831285361227, fd: 3,sin_family: 2,sin_port: 50000,sin_addr : 0.0.0.0